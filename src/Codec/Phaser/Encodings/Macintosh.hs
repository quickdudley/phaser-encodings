module Codec.Phaser.Encodings.Macintosh (
  macRoman,
  macRoman_encode
 ) where

import Data.Word

import Control.Applicative
import Control.Monad

import Codec.Phaser.Core

macRoman :: Monoid p => Phase p Word8 Char ()
macRoman = (<|> return ()) $ (>> macRoman) $ get >>= \b -> case b of
  _ | b < 0x80 -> yield $ toEnum $ fromIntegral b
  0x80 -> yield $ toEnum 0xc4
  0x81 -> yield $ toEnum 0xc5
  0x82 -> yield $ toEnum 0xc7
  0x83 -> yield $ toEnum 0xc9
  0x84 -> yield $ toEnum 0xd1
  0x85 -> yield $ toEnum 0xd6
  0x86 -> yield $ toEnum 0xdc
  0x87 -> yield $ toEnum 0xe1
  0x88 -> yield $ toEnum 0xe0
  0x89 -> yield $ toEnum 0xe2
  0x8a -> yield $ toEnum 0xe4
  0x8b -> yield $ toEnum 0xe3
  0x8c -> yield $ toEnum 0xe5
  0x8d -> yield $ toEnum 0xe7
  0x8e -> yield $ toEnum 0xe9
  0x8f -> yield $ toEnum 0xe8
  0x90 -> yield $ toEnum 0xea
  0x91 -> yield $ toEnum 0xeb
  0x92 -> yield $ toEnum 0xed
  0x93 -> yield $ toEnum 0xec
  0x94 -> yield $ toEnum 0xee
  0x95 -> yield $ toEnum 0xef
  0x96 -> yield $ toEnum 0xf1
  0x97 -> yield $ toEnum 0xf3
  0x98 -> yield $ toEnum 0xf2
  0x99 -> yield $ toEnum 0xf4
  0x9a -> yield $ toEnum 0xf6
  0x9b -> yield $ toEnum 0xf5
  0x9c -> yield $ toEnum 0xfa
  0x9d -> yield $ toEnum 0xf9
  0x9e -> yield $ toEnum 0xfb
  0x9f -> yield $ toEnum 0xfc
  0xa0 -> yield $ toEnum 0x2020
  0xa1 -> yield $ toEnum 0xb0
  0xa2 -> yield $ toEnum 0xa2
  0xa3 -> yield $ toEnum 0xa3
  0xa4 -> yield $ toEnum 0xa7
  0xa5 -> yield $ toEnum 0x2022
  0xa6 -> yield $ toEnum 0xb6
  0xa7 -> yield $ toEnum 0xdf
  0xa8 -> yield $ toEnum 0xae
  0xa9 -> yield $ toEnum 0xa9
  0xaa -> yield $ toEnum 0x2122
  0xab -> yield $ toEnum 0xb4
  0xac -> yield $ toEnum 0xa8
  0xad -> yield $ toEnum 0x2260
  0xae -> yield $ toEnum 0xc6
  0xaf -> yield $ toEnum 0xd8
  0xb0 -> yield $ toEnum 0x221e
  0xb1 -> yield $ toEnum 0xb1
  0xb2 -> yield $ toEnum 0x2264
  0xb3 -> yield $ toEnum 0x2265
  0xb4 -> yield $ toEnum 0xa5
  0xb5 -> yield $ toEnum 0xb5
  0xb6 -> yield $ toEnum 0x2202
  0xb7 -> yield $ toEnum 0x2211
  0xb8 -> yield $ toEnum 0x220f
  0xb9 -> yield $ toEnum 0x3c0
  0xba -> yield $ toEnum 0x222b
  0xbb -> yield $ toEnum 0xaa
  0xbc -> yield $ toEnum 0xba
  0xbd -> yield $ toEnum 0x3a9
  0xbe -> yield $ toEnum 0xe6
  0xbf -> yield $ toEnum 0xf8
  0xc0 -> yield $ toEnum 0xbf
  0xc1 -> yield $ toEnum 0xa1
  0xc2 -> yield $ toEnum 0xac
  0xc3 -> yield $ toEnum 0x221a
  0xc4 -> yield $ toEnum 0x192
  0xc5 -> yield $ toEnum 0x2248
  0xc6 -> yield $ toEnum 0x2206
  0xc7 -> yield $ toEnum 0xab
  0xc8 -> yield $ toEnum 0xbb
  0xc9 -> yield $ toEnum 0x2026
  0xca -> yield $ toEnum 0xa0
  0xcb -> yield $ toEnum 0xc0
  0xcc -> yield $ toEnum 0xc3
  0xcd -> yield $ toEnum 0xd5
  0xce -> yield $ toEnum 0x152
  0xcf -> yield $ toEnum 0x153
  0xd0 -> yield $ toEnum 0x2013
  0xd1 -> yield $ toEnum 0x2014
  0xd2 -> yield $ toEnum 0x201c
  0xd3 -> yield $ toEnum 0x201d
  0xd4 -> yield $ toEnum 0x2018
  0xd5 -> yield $ toEnum 0x2019
  0xd6 -> yield $ toEnum 0xf7
  0xd7 -> yield $ toEnum 0x25ca
  0xd8 -> yield $ toEnum 0xff
  0xd9 -> yield $ toEnum 0x178
  0xda -> yield $ toEnum 0x2044
  0xdb -> yield $ toEnum 0x20ac
  0xdc -> yield $ toEnum 0x2039
  0xdd -> yield $ toEnum 0x203a
  0xde -> yield $ toEnum 0xfb01
  0xdf -> yield $ toEnum 0xfb02
  0xe0 -> yield $ toEnum 0x2021
  0xe1 -> yield $ toEnum 0xb7
  0xe2 -> yield $ toEnum 0x201a
  0xe3 -> yield $ toEnum 0x201e
  0xe4 -> yield $ toEnum 0x2030
  0xe5 -> yield $ toEnum 0xc2
  0xe6 -> yield $ toEnum 0xca
  0xe7 -> yield $ toEnum 0xc1
  0xe8 -> yield $ toEnum 0xcb
  0xe9 -> yield $ toEnum 0xc8
  0xea -> yield $ toEnum 0xcd
  0xeb -> yield $ toEnum 0xce
  0xec -> yield $ toEnum 0xcf
  0xed -> yield $ toEnum 0xcc
  0xee -> yield $ toEnum 0xd3
  0xef -> yield $ toEnum 0xd4
  0xf0 -> yield $ toEnum 0xf8ff
  0xf1 -> yield $ toEnum 0xd2
  0xf2 -> yield $ toEnum 0xda
  0xf3 -> yield $ toEnum 0xdb
  0xf4 -> yield $ toEnum 0xd9
  0xf5 -> yield $ toEnum 0x131
  0xf6 -> yield $ toEnum 0x2c6
  0xf7 -> yield $ toEnum 0x2dc
  0xf8 -> yield $ toEnum 0xaf
  0xf9 -> yield $ toEnum 0x2d8
  0xfa -> yield $ toEnum 0x2d9
  0xfb -> yield $ toEnum 0x2da
  0xfc -> yield $ toEnum 0xb8
  0xfd -> yield $ toEnum 0x2dd
  0xfe -> yield $ toEnum 0x2db
  0xff -> yield $ toEnum 0x2c7

macRoman_encode :: Monoid p => Phase p Char Word8 ()
macRoman_encode = (<|> return ()) $ (>> macRoman_encode) $ get >>= \b -> case fromEnum b of
  b' | b' < 0x80 -> yield $ fromIntegral b'
  0xc4 -> yield 0x80
  0xc5 -> yield 0x81
  0xc7 -> yield 0x82
  0xc9 -> yield 0x83
  0xd1 -> yield 0x84
  0xd6 -> yield 0x85
  0xdc -> yield 0x86
  0xe1 -> yield 0x87
  0xe0 -> yield 0x88
  0xe2 -> yield 0x89
  0xe4 -> yield 0x8a
  0xe3 -> yield 0x8b
  0xe5 -> yield 0x8c
  0xe7 -> yield 0x8d
  0xe9 -> yield 0x8e
  0xe8 -> yield 0x8f
  0xea -> yield 0x90
  0xeb -> yield 0x91
  0xed -> yield 0x92
  0xec -> yield 0x93
  0xee -> yield 0x94
  0xef -> yield 0x95
  0xf1 -> yield 0x96
  0xf3 -> yield 0x97
  0xf2 -> yield 0x98
  0xf4 -> yield 0x99
  0xf6 -> yield 0x9a
  0xf5 -> yield 0x9b
  0xfa -> yield 0x9c
  0xf9 -> yield 0x9d
  0xfb -> yield 0x9e
  0xfc -> yield 0x9f
  0x2020 -> yield 0xa0
  0xb0 -> yield 0xa1
  0xa2 -> yield 0xa2
  0xa3 -> yield 0xa3
  0xa7 -> yield 0xa4
  0x2022 -> yield 0xa5
  0xb6 -> yield 0xa6
  0xdf -> yield 0xa7
  0xae -> yield 0xa8
  0xa9 -> yield 0xa9
  0x2122 -> yield 0xaa
  0xb4 -> yield 0xab
  0xa8 -> yield 0xac
  0x2260 -> yield 0xad
  0xc6 -> yield 0xae
  0xd8 -> yield 0xaf
  0x221e -> yield 0xb0
  0xb1 -> yield 0xb1
  0x2264 -> yield 0xb2
  0x2265 -> yield 0xb3
  0xa5 -> yield 0xb4
  0xb5 -> yield 0xb5
  0x2202 -> yield 0xb6
  0x2211 -> yield 0xb7
  0x220f -> yield 0xb8
  0x3c0 -> yield 0xb9
  0x222b -> yield 0xba
  0xaa -> yield 0xbb
  0xba -> yield 0xbc
  0x3a9 -> yield 0xbd
  0xe6 -> yield 0xbe
  0xf8 -> yield 0xbf
  0xbf -> yield 0xc0
  0xa1 -> yield 0xc1
  0xac -> yield 0xc2
  0x221a -> yield 0xc3
  0x192 -> yield 0xc4
  0x2248 -> yield 0xc5
  0x2206 -> yield 0xc6
  0xab -> yield 0xc7
  0xbb -> yield 0xc8
  0x2026 -> yield 0xc9
  0xa0 -> yield 0xca
  0xc0 -> yield 0xcb
  0xc3 -> yield 0xcc
  0xd5 -> yield 0xcd
  0x152 -> yield 0xce
  0x153 -> yield 0xcf
  0x2013 -> yield 0xd0
  0x2014 -> yield 0xd1
  0x201c -> yield 0xd2
  0x201d -> yield 0xd3
  0x2018 -> yield 0xd4
  0x2019 -> yield 0xd5
  0xf7 -> yield 0xd6
  0x25ca -> yield 0xd7
  0xff -> yield 0xd8
  0x178 -> yield 0xd9
  0x2044 -> yield 0xda
  0x20ac -> yield 0xdb
  0x2039 -> yield 0xdc
  0x203a -> yield 0xdd
  0xfb01 -> yield 0xde
  0xfb02 -> yield 0xdf
  0x2021 -> yield 0xe0
  0xb7 -> yield 0xe1
  0x201a -> yield 0xe2
  0x201e -> yield 0xe3
  0x2030 -> yield 0xe4
  0xc2 -> yield 0xe5
  0xca -> yield 0xe6
  0xc1 -> yield 0xe7
  0xcb -> yield 0xe8
  0xc8 -> yield 0xe9
  0xcd -> yield 0xea
  0xce -> yield 0xeb
  0xcf -> yield 0xec
  0xcc -> yield 0xed
  0xd3 -> yield 0xee
  0xd4 -> yield 0xef
  0xf8ff -> yield 0xf0
  0xd2 -> yield 0xf1
  0xda -> yield 0xf2
  0xdb -> yield 0xf3
  0xd9 -> yield 0xf4
  0x131 -> yield 0xf5
  0x2c6 -> yield 0xf6
  0x2dc -> yield 0xf7
  0xaf -> yield 0xf8
  0x2d8 -> yield 0xf9
  0x2d9 -> yield 0xfa
  0x2da -> yield 0xfb
  0xb8 -> yield 0xfc
  0x2dd -> yield 0xfd
  0x2db -> yield 0xfe
  0x2c7 -> yield 0xff
  _ -> fail "Character is unrepresentable in macRoman"
